(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{367:function(s,n,a){"use strict";a.r(n);var t=a(44),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vue业务实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue业务实战"}},[s._v("#")]),s._v(" Vue业务实战")]),s._v(" "),a("h2",{attrs:{id:"_01-封装echart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_01-封装echart"}},[s._v("#")]),s._v(" 01.封装Echart")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://huixiong.oss-cn-beijing.aliyuncs.com/fe-list/Echart_2020-04-27_16-09-10.png",alt:"echart"}})]),s._v(" "),a("p",[s._v("图表在To B的应用是经常出现的，折线图、柱状图和饼图等直观展示数据，"),a("a",{attrs:{href:"https://github.com/apache/incubator-echarts",target:"_blank",rel:"noopener noreferrer"}},[s._v("Echart"),a("OutboundLink")],1),s._v(" 有超过4万颗星，经历过各种业务场景的优化，是图表首选。另外可以选择"),a("a",{attrs:{href:"https://g2.antv.vision/zh/examples/gallery",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ant G2"),a("OutboundLink")],1),s._v(" ，移动端使用"),a("a",{attrs:{href:"https://f2.antv.vision/zh/docs/tutorial/getting-started",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ant F2"),a("OutboundLink")],1),s._v(" 。")]),s._v(" "),a("p",[s._v("相关链接：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://echarts.apache.org/examples/zh/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方实例"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://echarts.apache.org/zh/tutorial.html#5%20%E5%88%86%E9%92%9F%E4%B8%8A%E6%89%8B%20ECharts",target:"_blank",rel:"noopener noreferrer"}},[s._v("上手教程"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://echarts.apache.org/zh/option.html#title",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置项手册"),a("OutboundLink")],1),s._v(" 实例中的各种属性配置参数可以在这里查找。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://echarts.apache.org/zh/api.html#echarts",target:"_blank",rel:"noopener noreferrer"}},[s._v("API文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/apache/incubator-echarts/blob/master/index.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("按需引用的清单"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("图表的使用，Echart、G2、F2、G6都是需要一个指定的id节点来给他们查找DOM的，然后创建实例之后通过API绘图，通过对象的属性来配置各种绘图参数，因此我们可以将配置项(option对象)放在data里面，页面挂载之后实例调用options里的参数，根据图表的类型抽象成具体的组件，比如折线图组件、饼图组件、柱状图组件等。")]),s._v(" "),a("p",[a("strong",[s._v("饼图实例")]),s._v(" "),a("img",{attrs:{src:"https://huixiong.oss-cn-beijing.aliyuncs.com/fe-list/pie_chart_2020-04-28_10-47-16.png",alt:"pie-chart"}})]),s._v(" "),a("p",[s._v("安装："),a("code",[s._v("npm i echarts")])]),s._v(" "),a("p",[s._v("按需引入，创建utils文件夹放置这个按需文件：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import echarts from 'echarts/lib/echarts';\n\n// 引入需要的内容，如折线，标题，提示框\n// 需要引入什么看这个地址 https://github.com/apache/incubator-echarts/blob/master/index.js\nimport 'echarts/lib/chart/line'; // 折线图\nimport 'echarts/lib/chart/bar'; // 柱状图\nimport 'echarts/lib/component/legend'; // 图例组件\nimport 'echarts/lib/component/title'; // 标题设置\nimport 'echarts/lib/chart/pie'; // 饼图\nimport 'echarts/lib/component/tooltip'; // 提示框组件\n\nexport default echarts;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("封装饼状图表：")]),s._v(" "),a("ol",[a("li",[s._v("提供的id必须是动态的，因为这个是组件如果页面上存在相同的id节点会无法绘图。")]),s._v(" "),a("li",[s._v("在挂载的时候就创建echart实例，方便在方法中调用。")]),s._v(" "),a("li",[s._v("将需要动态配置的option项设置成props，比如图表标题、图列列表和数据。")]),s._v(" "),a("li",[s._v("监听页面的变化进行重绘，调用echart的resize API。工程上可以用lodash的节流函数"),a("a",{attrs:{href:"https://lodash.think2011.net/throttle",target:"_blank",rel:"noopener noreferrer"}},[s._v("throttle"),a("OutboundLink")],1),s._v(" 。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<template>\n    <div :id=\"id\" :style=\"{width: width, height: height}\"></div>\n</template>\n<script>\nimport echarts from '@/utils/lib/echarts';\n\nexport default {\n  props: {\n    // 容器宽度\n    width: {\n      type: String,\n      default: '100%',\n    },\n    // 容器高度\n    height: {\n      type: String,\n      default: '400px',\n    },\n    // 图表标题\n    title: {\n      type: String,\n      default: '饼图',\n    },\n    // 图例列表\n    legendData: {\n      type: Array,\n      default: () => [],\n    },\n    // 饼图数据data里的数据\n    dataList: {\n      type: Array,\n      default: () => [],\n    },\n  },\n  data() {\n    return {\n      id: `chart${Math.floor(Math.random() * 10000)}-${Math.floor(Math.random() * 10000)}`,\n      chartInstance: null, // 实例\n      timer: '',\n      option: {\n        title: {\n          text: this.title,\n          left: 'center',\n        },\n        tooltip: {\n          trigger: 'item',\n          formatter: '{a} <br/>{b} : {c} ({d}%)',\n        },\n        legend: {\n          orient: 'vertical',\n          left: 'left',\n          data: this.legendData,\n        },\n        series: [\n          {\n            name: '访问来源',\n            type: 'pie',\n            radius: '55%',\n            center: ['50%', '60%'],\n            data: this.dataList,\n            emphasis: {\n              itemStyle: {\n                shadowBlur: 10,\n                shadowOffsetX: 0,\n                shadowColor: 'rgba(0, 0, 0, 0.5)',\n              },\n            },\n          },\n        ],\n      },\n    };\n  },\n  mounted() {\n    this.chartInstance = echarts.init(document.getElementById(this.id));\n    this.drawChart();\n    window.addEventListener('resize', this.resize);\n  },\n  destroyed() {\n    window.removeEventListener('resize', this.resize);\n  },\n  methods: {\n    drawChart() {\n      this.chartInstance.setOption(this.option);\n    },\n    resize() {\n      clearTimeout(this.timer);\n      this.timer = setTimeout(() => {\n        this.chartInstance.resize();\n      }, 300);\n    },\n  },\n};\n<\/script>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br")])]),a("p",[s._v("组件调用：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<template>\n    <div>\n        <pie-chart\n          title=\"某站点用户来源统计\"\n          :legendData=\"legendList\"\n          :dataList=\"dataList\"\n        />\n    </div>\n</template>\n<script>\nimport PieChart from '@/components/Charts/PieChart.vue';\n\nexport default {\n  name: 'Chart',\n  components: {\n    PieChart,\n  },\n  data() {\n    return {\n      legendList: ['直接访问', '邮件营销', '联盟广告', '视频广告', '搜索引擎'],\n      dataList: [\n        { value: 335, name: '直接访问' },\n        { value: 310, name: '邮件营销' },\n        { value: 234, name: '联盟广告' },\n        { value: 135, name: '视频广告' },\n        { value: 1548, name: '搜索引擎' },\n      ],\n    };\n  },\n};\n<\/script>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[s._v("按需引入可以减少很多文件的加载，下面用"),a("a",{attrs:{href:"https://www.npmjs.com/package/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack-bundle-analyzer"),a("OutboundLink")],1),s._v("对比一下直接引入echart和按需的体积，从2.5M减少到了1.06M：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://huixiong.oss-cn-beijing.aliyuncs.com/fe-list/before_optimize_2020-04-28_10-01-58.png",alt:"before"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://huixiong.oss-cn-beijing.aliyuncs.com/fe-list/after_optimize_2020-04-28_10-06-50.png",alt:"after"}})]),s._v(" "),a("p",[s._v("业务中我们通常希望图表数据为空时隐藏图表，可以通过动态绑定属性来实现，比如将没数据时给组件添加的类中属性opacity值为0, 有数据时值为1。另外可以考虑用v-show。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<template>\n\t<pie-chart :class=\"[dataList.length === 0 ? 'hide' : '']\" />\n<template>\n<style>\n\t.hide{\n        opacity: 0;\n     }\n</style>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);